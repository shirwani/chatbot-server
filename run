python3 -m venv venv

source venv/bin/activate
alias python="venv/bin/python3"
alias pip="venv/bin/pip3"

pip install --upgrade pip
pip install -r requirements.txt

pkill -f chat_client.py
pkill -f chat_server.py

fuser -k 8000/tcp
fuser -k 8001/tcp

python chat_server.py &
python chat_client.py &


# scp ../clothes.csv root@173.255.238.242:/var/www/flask-apps/.
# export CLIENT_SITES_LOCATION="/var/www/flask-apps/chatbot-client-sites"
# export CLIENT_SITE="bolangaro.com"


# ON REMOTE SERVER


# gunicorn -b 0.0.0.0:8001 chat_server:app # to test out the server without systemd

# For saving the cache files generated by the server, we need to create a directory for them and set the appropriate permissions.
# The server will likely need to write to this directory, so we will set the ownership to www-data (the user that
# typically runs web servers) and set the permissions to allow writing.
sudo mkdir -p /var/www/.cache
sudo chown -R www-data:www-data /var/www/.cache
sudo find /var/www/.cache -type d -exec chmod 755 {} +
sudo find /var/www/.cache -type f -exec chmod 644 {} +


sudo systemctl daemon-reload
sudo systemctl enable --now customizable-chatbot-server

fuser -k 8001/tcp

sudo systemctl daemon-reload
sudo systemctl stop customizable-chatbot-server
sudo systemctl reset-failed customizable-chatbot-server

sudo systemctl restart customizable-chatbot-server
sudo systemctl status customizable-chatbot-server --no-pager
sudo journalctl -u customizable-chatbot-server -f

